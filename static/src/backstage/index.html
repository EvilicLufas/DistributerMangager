<!DOCTYPE HTML>
<html>
<head>
	<meta charset="UTF-8">
	<title>经销商管理系统</title>
	<script type="text/javascript" src="/fishstrap/lib/mod.js"></script>
</head>
<body>
	<script type="text/javascript">
		var $ = require('/fishstrap/core/global.js');
		var dialog = require('/fishstrap/ui/dialog.js');
		var indexPage = require('/fishstrap/page/indexPage.js');
		var menu = {};
		var user = {};
		function setMenu(next){
			$.get('/login/islogin?t='+Math.random(),{},function(data){
				data = $.JSON.parse(data);
				if( data.code != 0 ){
					location.href = 'login.html';
					return;
				}
				user = data.data;
				if( user.type == 1 ){
					//管理员
					menu = {
						'系统管理':{
							'系统管理':[
								{name:'帐号管理',url:'view/user/index.html'},
								{name:'密码管理',url:'view/password/index.html'}
							]
						},
						'公司介绍':{
							'公司介绍':[
								{name:'模板管理',url:'view/template/index.html'},
							]
						},
					}
				}else if( user.type == 2 ){
					//代理商
					menu = {
						'系统管理':{
							'系统管理':[
								{name:'帐号管理',url:'view/user/viewByAgent.html?userId='+user.userId},
								{name:'密码管理',url:'view/password/index.html'}
							]
						},
					}
				}else{
					//商城用户
					menu = {
						'系统管理':{
							'系统管理':[
								{name:'帐号管理',url:'view/user/viewByClient.html?userId='+user.userId},
								{name:'密码管理',url:'view/password/index.html'}
							],
							'微信设置':[
								{name:'微信设置',url:'view/commodityapp/index.html'},
							],
							'回复设置':[
								{name:'被关注回复',url:'view/auto-response/index.html?userId='+user.userId},
							]
						},
						'公司介绍':{
							'公司介绍':[
								{name:'分类管理',url:'view/classify/index.html'},
								{name:'文章管理',url:'view/article/index.html'},
								{name:'广告管理',url:'view/banner/index.html'},
								{name:'模板管理',url:'view/template/viewMyTemplate.html'},
							]
						},
						'商城管理':{
							'商城管理':[
								{name:'用户管理',url:'view/client/index.html'},
								{name:'分类管理',url:'view/commodityclassify/index.html'},
								{name:'商品管理',url:'view/commodity/index.html'},
								{name:'订单管理',url:'view/order/index.html'},
							],
							'营销管理':[
								{name:'抽奖管理',url:'view/luckydraw/index.html'},
								{name:'会员卡设置',url:'view/vip/viewSetting.html'},
								{name:'会员卡管理',url:'view/vip/indexCard.html'},
								{name:'红包管理',url:'view/redpack/viewSetting.html'},
							],
							'统计管理':[
								{name:'订单流水日统计',url:'view/order/orderdaystatistic.html'},
								{name:'订单流水总统计',url:'view/order/orderstatistic.html'},
							]
						},
						'分成管理':{
							'分成管理':[
								{name:'供货商',url:'view/distribution/upUserIndex.html'},
								{name:'应得分成',url:'view/distribution/upOrderIndex.html'},
								{name:'分销商',url:'view/distribution/downUserIndex.html'},
								{name:'分销分成',url:'view/distribution/downOrderIndex.html'},
							]
						},
					}
				}
				next();
			});
		}
		function go(){
			indexPage.use({
				title:'经销商管理系统('+user.name+')',
				init:function(){
					
				},
				logout:function(){
					$.get('/login/checkout?t='+Math.random(),{},function(data){
						data = $.JSON.parse(data);
						if( data.code != 0 ){
							dialog.message(data.msg);
							return;
						}
						location.href = 'login.html';
					});
				},
				menu:menu
			});
		}
		setMenu(go);
	</script>
 </body>
</html>
